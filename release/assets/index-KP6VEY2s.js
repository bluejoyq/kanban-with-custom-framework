(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&c(g)}).observe(document,{childList:!0,subtree:!0});function u(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(a){if(a.ep)return;a.ep=!0;const i=u(a);fetch(a.href,i)}})();const T=(n,t=100)=>{let u=null;return(...c)=>{u&&clearTimeout(u),u=setTimeout(()=>{n(...c)},t)}},x=n=>{let t=null;return(...u)=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{n(...u)})}},w=()=>{let n=null,t=null;const u=(s,l)=>{n=s,n.innerHTML="",t=l,I()},c=s=>{let l=s;return[()=>l,d=>{l=d,I()}]},a=(s,l)=>{if(s!=null){if(l==null){s.remove();return}if(s.nodeType!==l.nodeType||s.nodeType!==Node.TEXT_NODE&&s.getAttribute("key")!==l.getAttribute("key")){s.replaceWith(l);return}if(s.nodeType===Node.TEXT_NODE&&s.textContent!==l.textContent){s.textContent=l.textContent;return}if(s.nodeName!==l.nodeName){s.replaceWith(l);return}i(s,l),g(s,l)}},i=(s,l)=>{const m=s.attributes,r=l.attributes;Array.from(m??[]).forEach(d=>{const e=d.name;r.getNamedItem(e)||s.removeAttribute(e)}),Array.from(r??[]).forEach(d=>{m.getNamedItem(d.name)||s.setAttribute(d.name,d.value)})},g=(s,l)=>{const m=Array.from(s.childNodes),r=Array.from(l.childNodes),d=Math.max(m.length,r.length);for(let e=0;e<d;e++){if(e>=r.length){s.removeChild(m[e]);continue}if(e>=m.length){s.appendChild(r[e]);continue}a(m[e],r[e])}},I=x(()=>{const s=t(),l=n.firstChild;if(l==null){n.appendChild(s);return}a(l,s)});return{createRoot:u,useState:c}},{createRoot:O,useState:S}=w(),D=({tagName:n,children:t,...u})=>{const c=document.createElement(n);return t.forEach(a=>{typeof a=="string"&&c.appendChild(document.createTextNode(a)),typeof a=="number"&&c.appendChild(document.createTextNode(a.toString())),a instanceof HTMLElement&&c.appendChild(a)}),Object.keys(u).forEach(a=>{if(a.startsWith("on")){c.addEventListener(a.substring(2).toLowerCase(),u[a]);return}c.setAttribute(a,u[a])}),c},p=({children:n=[],...t})=>D({tagName:"div",children:n,...t}),K=({children:n=[],...t})=>D({tagName:"h1",children:n,...t}),L=({children:n=[],...t})=>D({tagName:"h2",children:n,...t}),k=({children:n=[],...t})=>D({tagName:"button",children:n,...t}),y=({children:n=[],...t})=>D({tagName:"span",children:n,...t}),v=({children:n=[],...t})=>D({tagName:"input",children:n,...t}),M=()=>({children:n,onClose:t})=>p({children:[p({children:[...n],class:"modal-container",onclick:u=>{u.stopPropagation()}})],class:"modal-layout",onclick:t}),_=()=>({issue:n,onClose:t,onSubmit:u})=>{let c=(n==null?void 0:n.title)??"",a=(n==null?void 0:n.authorId)??"";const i=()=>{if(!c.trim()||!a.trim()){alert("빈칸을 모두 채워주세요");return}u(c,a),t()};return p({children:[p({children:[y({children:["이슈 제목"]}),v({placeholder:"이슈 제목을 입력해주세요",value:c,onchange:g=>{c=g.target.value}})]}),p({children:[y({children:["담당자 id"]}),v({placeholder:"담당자 id를 입력해주세요",value:a,onchange:g=>{a=g.target.value}})]}),p({children:[k({children:["취소"],onclick:t}),k({children:["확인"],onclick:i})]})]})};class N{constructor(t){this.title=t.title,this.authorId=t.authorId,this.id=t.id,this.status=t.status,t.createdAt instanceof Date&&(this.createdAt=t.createdAt),typeof t.updatedAt=="string"&&(this.updatedAt=new Date(t.updatedAt)),t.updatedAt instanceof Date&&(this.updatedAt=t.updatedAt),typeof t.createdAt=="string"&&(this.createdAt=new Date(t.createdAt))}}const W=(n,t,u,c,a,i)=>{let g=null;const I=s=>{g=s};return()=>{const l=t().map(e=>q(e,c,a)),m=T(e=>{const h=document.querySelector(`#${n}`),o=document.querySelector(".is-dragging");if(h==null||o==null)return;o.parentElement.removeChild(o);const b=d(h,e.clientY);if(o.setAttribute("key",new Date().getTime().toString()),b==null){I(-1),h.appendChild(o);return}I([...h.children].indexOf(b)),h.insertBefore(o,b)},10),r=T(e=>{u(e,e.status,n,g),I(null)},10),d=(e,h)=>{const o=e.querySelectorAll(".kanban-item");return o.length===0?null:[...o].reduce((f,A)=>{const E=A.getBoundingClientRect(),C=h-E.top-E.height/2;return C<0&&C>f.offset?{offset:C,element:A}:f},{offset:Number.NEGATIVE_INFINITY}).element};return p({children:[p({children:[L({children:[n],class:"kanban-col-title"}),k({children:["추가"],onclick:()=>{i(n)}})],class:"kanban-col-header"}),p({children:[...l.map(e=>e===null?p({class:"kanban-item-placeholder"}):e())],class:"kanban-items-container",id:n})],class:"kanban-col",ondragenter:e=>{e.preventDefault()},ondrop:e=>{e.preventDefault();const h=e.dataTransfer.getData("text/plain"),o=new N(JSON.parse(h));r(o)},ondragleave:e=>{e.preventDefault()},ondragover:e=>{e.preventDefault(),m(e)}})}},q=(n,t,u)=>{const c=()=>{confirm("삭제하시겠습니까?")&&t(n)},a=()=>{u(n)};return()=>p({"data-id":n.id,key:JSON.stringify(n),children:[p({children:[y({children:[n.id]}),k({children:["수정"],onclick:a}),k({children:["삭제"],onclick:c})],class:"kanban-item-header"}),p({children:[y({children:[n.title],class:"kanban-item-title"})],class:"kanban-item-body"}),p({children:[y({children:[n.authorId],class:"kanban-item-content"}),y({children:[n.createdAt.toLocaleString()],class:"kanban-item-content"})],class:"kanban-item-footer"})],draggable:!0,class:"kanban-item",ondragstart:i=>{i.target.classList.add("is-dragging"),i.dataTransfer.setData("text/plain",JSON.stringify(n))},ondragend:i=>{i.target.classList.remove("is-dragging"),i.preventDefault()}})},F=()=>{const n=["to-do","in-progress","done"];let t=0;const u=n.reduce((r,d,e)=>(r[d]=[],r),{}),[c,a]=S(u),i=()=>{const r=localStorage.getItem("kanbanDatas"),d=localStorage.getItem("startIdx");if(d!=null&&(t=Number(d)),r==null)return;const e=JSON.parse(r),h={...u};Object.keys(e).forEach(o=>{h[o]=e[o].map(b=>new N({...b}))}),a(h)},g=()=>{localStorage.setItem("kanbanDatas",JSON.stringify(c())),localStorage.setItem("startIdx",t)},I=(r,d,e,h)=>{const o=h??-1,b=c();if(b[d].filter(A=>A.id===r.id).length==0)return;const f={...b};f[d]=f[d].filter(A=>A.id!==r.id),r.status=e,f[e]=[...f[e]],f[e].splice(o===-1?f[e].length:o,0,r),a(f),g()},s=(r,d,e)=>{const o={...c()},b=new N({id:`issue-${t}`,title:r,status:e,authorId:d,createdAt:new Date,updatedAt:new Date});o[e]=[...o[e],b],a(o),t+=1,g()},l=(r,d,e)=>{const o={...c()},b=new N({...r,title:d,authorId:e,updatedAt:new Date});o[r.status]=o[r.status].map(f=>f.id===r.id?b:f),a(o),g()},m=r=>{console.log(r);const e={...c()};e[r.status]=e[r.status].filter(h=>h.id!==r.id),a(e),g()};return i(),{getKanbanDatas:c,handleMoveIssue:I,handleWriteIssue:s,handleDeleteIssue:m,handleEditIssue:l,kanbanTitles:n}},H=()=>{const{kanbanTitles:n,getKanbanDatas:t,handleMoveIssue:u,handleWriteIssue:c,handleEditIssue:a,handleDeleteIssue:i}=F(),[g,I]=S(null),[s,l]=S(null),m=()=>{l(null)},r=()=>{I(null)},d=n.map(o=>W(o,()=>t()[o],u,i,I,l)),e=M(),h=_();return()=>{const o=s(),b=g();return p({children:[K({children:["칸반 보드"]}),p({children:[...d.map(f=>f())],class:"kanban"}),o!=null&&e({children:[h({issue:o,onSubmit:(f,A)=>{c(f,A,o)},onClose:m})],onClose:m}),b!=null&&e({children:[h({issue:b,onSubmit:(f,A)=>{a(b,f,A)},onClose:r})],onClose:r})],class:"layout"})}};O(document.querySelector("#app"),H());
